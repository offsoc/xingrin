import { api } from "@/lib/api-client"
import type { GetVulnerabilitiesParams } from "@/types/vulnerability.types"

export class VulnerabilityService {
  /** 获取所有漏洞列表（全局漏洞页使用） */
  static async getAllVulnerabilities(
    params: GetVulnerabilitiesParams,
    filter?: string,
  ): Promise<any> {
    const response = await api.get(`/assets/vulnerabilities/`, {
      params: { ...params, filter },
    })
    return response.data
  }

  /** 按扫描任务获取漏洞快照列表（扫描历史页使用） */
  static async getVulnerabilitiesByScanId(
    scanId: number,
    params: GetVulnerabilitiesParams,
    filter?: string,
  ): Promise<any> {
    const response = await api.get(`/scans/${scanId}/vulnerabilities/`, {
      params: { ...params, filter },
    })
    return response.data
  }

  /** 按目标获取漏洞资产列表（目标详情页使用） */
  static async getVulnerabilitiesByTargetId(
    targetId: number,
    params: GetVulnerabilitiesParams,
    filter?: string,
  ): Promise<any> {
    const response = await api.get(`/targets/${targetId}/vulnerabilities/`, {
      params: { ...params, filter },
    })
    return response.data
  }
}
